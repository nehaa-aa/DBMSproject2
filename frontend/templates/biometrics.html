{% extends "base.html" %}
{% block title %}Update Biometrics ‚Äî Smart Nutrition{% endblock %}
{% block content %}
<div class="biometrics-container">
  <h2>‚öñÔ∏è Update Your Biometrics</h2>
  <p class="muted">Track your physical measurements and health goals. BMI is calculated automatically.</p>

  {% if current %}
  <div class="card current-stats">
    <h3>Current Measurements</h3>
    <div class="stats-row">
      <div class="stat">
        <span class="stat-label">Height</span>
        <span class="stat-value">{{ current.height_cm }} cm</span>
      </div>
      <div class="stat">
        <span class="stat-label">Weight</span>
        <span class="stat-value">{{ current.weight_kg }} kg</span>
      </div>
      <div class="stat">
        <span class="stat-label">BMI</span>
        <span class="stat-value bmi">{{ current.bmi }}</span>
      </div>
      <div class="stat">
        <span class="stat-label">Last Updated</span>
        <span class="stat-value small">{{ current.updated_at.strftime('%b %d, %Y') }}</span>
      </div>
    </div>
  </div>
  {% endif %}

  <div class="card form-card">
    <h3>Enter New Measurements</h3>
    <form method="post" class="biometrics-form">
      <div class="form-section">
        <h4>üìè Physical Measurements</h4>
        <div class="grid-2">
          <div class="form-group">
            <label for="height_cm">Height (cm) *</label>
            <input type="number" 
                   id="height_cm"
                   name="height_cm" 
                   step="0.1" 
                   min="50" 
                   max="250"
                   value="{{ current.height_cm if current else '' }}"
                   placeholder="e.g., 170.5" 
                   required>
            <small class="help-text">Enter your height in centimeters</small>
          </div>
          
          <div class="form-group">
            <label for="weight_kg">Weight (kg) *</label>
            <input type="number" 
                   id="weight_kg"
                   name="weight_kg" 
                   step="0.1" 
                   min="20" 
                   max="300"
                   placeholder="e.g., 70.5" 
                   required>
            <small class="help-text">Enter your current weight</small>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h4>üéØ Health Goals</h4>
        <div class="form-group">
          <label for="goal">Primary Goal *</label>
          <select id="goal" name="goal" required>
            <option value="maintain" {% if current and current.goal == 'maintain' %}selected{% endif %}>
              Maintain Current Weight
            </option>
            <option value="loss" {% if current and current.goal == 'loss' %}selected{% endif %}>
              Lose Weight
            </option>
            <option value="gain" {% if current and current.goal == 'gain' %}selected{% endif %}>
              Gain Weight
            </option>
          </select>
        </div>
        
        <div class="form-group">
          <label for="target_weight_kg">Target Weight (kg)</label>
          <input type="number" 
                 id="target_weight_kg"
                 name="target_weight_kg" 
                 step="0.1"
                 min="20"
                 max="300"
                 value="{{ current.target_weight_kg if current else '' }}"
                 placeholder="e.g., 65.0">
          <small class="help-text">Optional: Set a target weight for your goal</small>
        </div>
      </div>

      <div class="form-section">
        <h4>üèÉ Activity Level</h4>
        <div class="form-group">
          <label for="activity_level">Current Activity Level</label>
          <select id="activity_level" name="activity_level">
            <option value="sedentary" {% if current and current.activity_level == 'sedentary' %}selected{% endif %}>
              Sedentary (Little or no exercise)
            </option>
            <option value="light" {% if current and current.activity_level == 'light' %}selected{% endif %}>
              Light (Exercise 1-3 days/week)
            </option>
            <option value="moderate" {% if current and current.activity_level == 'moderate' %}selected{% endif %}>
              Moderate (Exercise 3-5 days/week)
            </option>
            <option value="active" {% if current and current.activity_level == 'active' %}selected{% endif %}>
              Active (Exercise 6-7 days/week)
            </option>
            <option value="very_active" {% if current and current.activity_level == 'very_active' %}selected{% endif %}>
              Very Active (Physical job + exercise)
            </option>
          </select>
          <small class="help-text">This helps estimate your daily calorie needs</small>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-primary btn-large">
          üíæ Save Measurements
        </button>
        <a href="/dashboard" class="btn-outline">Cancel</a>
      </div>
    </form>
  </div>

  <div class="card info-card">
    <h3>üìö Understanding BMI</h3>
    <div class="bmi-ranges">
      <div class="bmi-range underweight">
        <span class="range-label">Underweight</span>
        <span class="range-value">&lt; 18.5</span>
      </div>
      <div class="bmi-range normal">
        <span class="range-label">Normal</span>
        <span class="range-value">18.5 - 24.9</span>
      </div>
      <div class="bmi-range overweight">
        <span class="range-label">Overweight</span>
        <span class="range-value">25.0 - 29.9</span>
      </div>
      <div class="bmi-range obese">
        <span class="range-label">Obese</span>
        <span class="range-value">‚â• 30.0</span>
      </div>
    </div>
    <p class="info-note">
      <strong>Note:</strong> BMI is a screening tool. It doesn't directly measure body fat and may not be accurate for athletes, elderly, or pregnant individuals. Consult healthcare professionals for personalized advice.
    </p>
  </div>
</div>

<style>
.biometrics-container {
  max-width: 800px;
  margin: 0 auto;
}

.current-stats {
  background: linear-gradient(135deg, rgba(79, 157, 246, 0.08), rgba(34, 197, 94, 0.08));
  margin-bottom: 24px;
}

.stats-row {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 16px;
  margin-top: 16px;
}

.stat {
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 12px;
  background: white;
  border-radius: 8px;
  border: 1px solid var(--border);
}

.stat-label {
  font-size: 11px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.stat-value {
  font-size: 22px;
  font-weight: 700;
  color: var(--text);
}

.stat-value.bmi {
  color: var(--primary);
}

.stat-value.small {
  font-size: 14px;
  font-weight: 600;
}

.form-card {
  margin-bottom: 24px;
}

.biometrics-form {
  margin-top: 20px;
}

.form-section {
  margin-bottom: 28px;
  padding: 20px;
  background: rgba(247, 250, 252, 0.5);
  border-radius: 12px;
  border: 1px dashed var(--border);
}

.form-section h4 {
  margin: 0 0 16px;
  color: var(--text);
  font-size: 16px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.form-group {
  margin-bottom: 20px;
}

.form-group label {
  display: block;
  margin-bottom: 6px;
  font-weight: 600;
  color: var(--text);
  font-size: 14px;
}

.form-group input,
.form-group select {
  width: 100%;
  padding: 12px 14px;
  border: 1px solid var(--border);
  border-radius: 10px;
  font-size: 15px;
  transition: all 0.2s ease;
  background: white;
}

.form-group input:focus,
.form-group select:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(79, 157, 246, 0.1);
}

.help-text {
  display: block;
  margin-top: 6px;
  font-size: 12px;
  color: var(--muted);
  font-style: italic;
}

.grid-2 {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 16px;
}

.form-actions {
  display: flex;
  gap: 12px;
  margin-top: 28px;
  padding-top: 20px;
  border-top: 1px solid var(--border);
}

.btn-large {
  padding: 14px 28px;
  font-size: 16px;
}

.info-card {
  background: linear-gradient(135deg, rgba(245, 158, 11, 0.08), rgba(255, 255, 255, 0.95));
  border-left: 4px solid var(--warn);
}

.bmi-ranges {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
  gap: 12px;
  margin: 16px 0 20px;
}

.bmi-range {
  padding: 14px;
  border-radius: 10px;
  text-align: center;
  display: flex;
  flex-direction: column;
  gap: 6px;
}

.bmi-range.underweight {
  background: #fef3c7;
  border: 2px solid #fbbf24;
}

.bmi-range.normal {
  background: #d1fae5;
  border: 2px solid #22c55e;
}

.bmi-range.overweight {
  background: #fed7aa;
  border: 2px solid #f97316;
}

.bmi-range.obese {
  background: #fecaca;
  border: 2px solid #ef4444;
}

.range-label {
  font-size: 12px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.range-value {
  font-size: 16px;
  font-weight: 700;
}

.info-note {
  padding: 14px;
  background: rgba(255, 255, 255, 0.6);
  border-radius: 8px;
  font-size: 13px;
  line-height: 1.6;
  color: var(--muted);
}

.info-note strong {
  color: var(--text);
}

@media (max-width: 640px) {
  .grid-2 {
    grid-template-columns: 1fr;
  }
  
  .stats-row {
    grid-template-columns: 1fr 1fr;
  }
  
  .bmi-ranges {
    grid-template-columns: 1fr 1fr;
  }
  
  .form-actions {
    flex-direction: column;
  }
}
</style>
{% endblock %}